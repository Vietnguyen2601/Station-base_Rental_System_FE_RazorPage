@page
@model EVStationRental.Presentation.Pages.Feedback.MyModel
@{
    ViewData["Title"] = "Đánh giá của tôi";
}

<div class="page-card">
    <div class="d-flex justify-content-between align-items-center flex-wrap gap-2 mb-3">
        <h2 class="mb-0">Đánh giá của tôi</h2>
        <span class="text-muted">@Model.TotalItems đánh giá</span>
    </div>
    <partial name="~/Pages/Shared/_Alerts.cshtml" />

    @if (!Model.Items.Any())
    {
        <div class="flash flash-info">Bạn chưa có đánh giá nào.</div>
    }
    else
    {
        <div class="table-responsive">
            <table class="table table-modern align-middle">
                <thead>
                    <tr>
                        <th>Mã đơn</th>
                        <th>Số sao</th>
                        <th>Nhận xét</th>
                        <th>Ngày đánh giá</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="feedbackTable">
                @foreach (var feedback in Model.Items)
                {
                    <tr class="feedback-row">
                        <td>
                            <div class="fw-semibold">@feedback.OrderCode</div>
                            <small class="text-muted">@feedback.OrderStart:g → @feedback.OrderEnd?.ToString("g")</small>
                        </td>
                        <td>@feedback.Rating / 5</td>
                        <td>@(string.IsNullOrWhiteSpace(feedback.Comment) ? "(Không có nhận xét)" : feedback.Comment)</td>
                        <td>@feedback.CreatedAt:g</td>
                        <td class="text-end">
                            <a class="btn btn-outline btn-sm" asp-page="/Orders/Details" asp-route-id="@feedback.OrderId">Xem đơn</a>
                        </td>
                    </tr>
                }
                </tbody>
            </table>
        </div>
        <div id="feedbackPagination" class="mt-3"></div>
    }
</div>

@section Scripts {
    <script src="~/js/pagination.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (window.generatePagination) {
                generatePagination('#feedbackPagination', '.feedback-row', @Model.PageSize, 'Trước', 'Sau');
            }
        });
    </script>
}
